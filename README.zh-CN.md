# MouseFix

<div align="center">

![Version](https://img.shields.io/badge/version-1.0.3-blue.svg)
![Platform](https://img.shields.io/badge/platform-Windows-lightgrey.svg)
![License](https://img.shields.io/badge/license-MIT-green.svg)
![Size](https://img.shields.io/badge/size-120KB-orange.svg)

**让你的鼠标不再误触 —— 一键解决双击和滚轮故障**

[English](README.md) | [🚀 快速开始](#快速开始) | [📥 下载](#下载)

</div>

---

## 🎯 什么是 MouseFix？

**你的鼠标是否正在“背刺”你？**

- 💥 **致命双击**：明明只点了一下，文件却被打开了，或者把关键装备卖了两次。
- 🌀 **幽灵滚轮**：网页看着看着突然反向乱跳，心态崩了。
- 💢 **拖拽断触**：拖拽文件或选中文字时突然断开，操作全白费。

**硬件老化？软件续命！**

这通常是微动开关老化导致的“回弹抖动（Switch Bounce）”。无需更换鼠标，MouseFix 用**工业级算法**为你的鼠标注入第二生命。

**MouseFix 的降维打击：**

- 🛡️ **智能点击过滤**：毫秒级精准识别，只放过你真实的点击，拦截一切杂波。
- 🧠 **Smart Drag 拖拽保护**：独家混合启发式算法，完美修复拖拽断连，稳如泰山。
- 🎡 **滚轮反向修正**：彻底消除滚轮编码器老化带来的反向跳动。
- 🚀 **零感无缝运行**：无窗口、无干扰、超低资源占用，就像它不存在一样。
- 💎 **开源且免费**：没有广告，没有套路，只有纯粹的功能。

---

## ✨ 核心功能

### 🎯 全方位保护

- **支持所有鼠标按键**：左键、右键、中键、侧键（X1/X2）和滚轮
- **智能拖拽（混合启发式算法）**：区分点击与拖拽操作，防止拖拽中途断触，同时保持极速点击响应
- **滚轮防抖**：防止滚轮反向滚动和跳页
- **极致性能**：底层 C 语言编写，采用缓存行对齐优化，系统资源占用几乎为零
- **静默运行**：不产生日志文件，不干扰正常使用

### 🎨 简单易用的界面

- **系统托盘集成**：静默运行在通知区域，不占用桌面空间
- **右键菜单配置**：所有设置都可以通过右键菜单快速访问
- **可视化反馈**：勾选标记清晰显示已启用的按键
- **实时统计**：查看已拦截的误触事件数量

### ⚡ 先进核心技术

- **智能拖拽（Smart Drag / Hybrid Heuristic）**：
  传统的去抖软件可能会在拖拽释放时误判抖动，导致“意外掉落”。
  MouseFix 采用智能算法识别“点击”与“拖拽”：
  - **点击**：极速响应，标准去抖。
  - **拖拽**：当你长按（>200ms）或移动鼠标（>5px）时，算法会智能校验释放动作。
  - **结果**：拖拽稳如泰山，点击快如闪电。

- **工业级内核时钟**：
  基于 64 位 `GetTickCount64` 内核计时架构，彻底突破 32 位系统的时间物理极限，实现 7x24 小时全天候零故障运行。

- **超低延迟架构**：
  纯 C 语言编写的高性能 Hook，输入延迟极低（<1ms），游戏办公两不误。

### ⚡ 三种预设模式，一键切换

| 预设模式 | 按键阈值 | 滚轮阈值 | 适用场景 |
|---------|---------|---------|---------|
| 🎯 **默认模式** | 50ms | 30ms | 日常使用，平衡性能和灵敏度 |
| 💼 **办公模式** | 60ms | 40ms | 文档编辑、表格处理，更严格过滤 |
| 🎮 **严格模式** | 40ms | 20ms | 精密操作、游戏，快速响应 |

### 🔧 独立控制每个按键

你可以为每个鼠标按键单独设置：
- ✓ 左键（最常用的按键）
- ✓ 右键（上下文菜单）
- ✓ 中键（滚轮点击）
- ✓ X1 键（后退/侧键）
- ✓ X2 键（前进/侧键）
- ✓ 滚轮滚动（支持自定义 1-200ms）

---

## 📥 下载

### 最新版本

[查看所有版本](https://github.com/matreshka15/MouseFix/releases)

**选择哪个版本？**
- **64位版本**：适合大多数现代电脑（推荐）
- **32位版本**：适合较旧的 32 位系统

---

## 🚀 快速开始

1. **下载**并解压 MouseFix（推荐 64位版本）
2. **运行** `MouseFix-x64.exe`（或 `MouseFix-x86.exe`）- 程序出现在系统托盘中
3. **右键点击**托盘图标进行配置：
   - 切换按键（左键、右键、中键、X1、X2、滚轮）
   - 选择预设（默认/办公/严格）或自定义阈值
4. **退出**时右键点击托盘图标

**注意：** 程序只能运行一个实例，设置会自动保存到 Windows 注册表中。

---

## 🔧 开机自启动配置

使用提供的 PowerShell 脚本轻松配置 MouseFix 开机自启动：

1. **运行** `add_to_startup.ps1`（右键选择"使用 PowerShell 运行"）
2. **选择**启动方式：
   - **启动文件夹**（推荐）- 易于管理，可在启动应用中查看
   - **注册表** - 隐藏的系统级启动
3. **完成** - MouseFix 将在下次登录时自动启动

如需取消自启动，再次运行脚本并选择"取消自启动"。

**提示：** 按 `Win+R` 并输入 `shell:startup` 可查看启动文件夹内容。

---

## ❓ 常见问题

**Q: 程序运行后仍然有误触怎么办？**
A: 切换到 **办公模式**（60ms）或自定义阈值为 80-120ms。

**Q: 滚轮滚动感觉有延迟怎么办？**
A: 禁用滚轮防抖（取消勾选 Wheel）或将滚轮阈值降低到 20ms。

**Q: 程序无法启动，提示"MouseFix is already running!"？**
A: 检查系统托盘中是否已有 MouseFix 图标。如果没有，重启电脑即可。

**Q: 每次重启电脑后设置都重置了？**
A: 设置现已支持持久化存储（通过 Windows 注册表 `HKCU\Software\MouseFix`）。程序会自动恢复你上次的配置。

**Q: 杀毒软件报警怎么办？**
A: 添加到杀毒软件白名单。程序使用系统级鼠标钩子，但不会收集数据。

---

## 📄 开源协议

本项目采用 MIT 开源协议，详见 [LICENSE](LICENSE) 文件。

---

## 🙏 致谢

- **原始概念**：[marvinlehmann](https://github.com/marvinlehmann)
- **分支改进**：[matreshka15](https://github.com/matreshka15)

---

<div align="center">

**如果 MouseFix 帮到了你，请给我们一个 ⭐ Star！**

[回到顶部](#mousefix)

</div>